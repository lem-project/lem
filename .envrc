use flake

# direnv's `use flake` doesn't export LD_LIBRARY_PATH by default
# We need to extract it from nix print-dev-env
if [[ -f flake.nix ]]; then
  ld_path=$(nix print-dev-env 2>/dev/null | grep "^export LD_LIBRARY_PATH=" | cut -d'"' -f2)
  if [[ -n "$ld_path" ]]; then
    export LD_LIBRARY_PATH="$ld_path"
  fi
fi
